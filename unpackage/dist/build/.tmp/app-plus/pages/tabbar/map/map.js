(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tabbar/map/map"],{"2a84":function(t,i,e){"use strict";var a=e("3a03"),o=e.n(a);o.a},"3a03":function(t,i,e){},"4b4c":function(t,i,e){"use strict";e.r(i);var a=e("c10d"),o=e("c3ac");for(var s in o)"default"!==s&&function(t){e.d(i,t,function(){return o[t]})}(s);e("2a84");var n=e("2877"),d=Object(n["a"])(o["default"],a["a"],a["b"],!1,null,null,null);i["default"]=d.exports},afaa:function(module,exports,__webpack_require__){"use strict";(function(__f__,uni){Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _amapWx=_interopRequireDefault(__webpack_require__("b058")),_json=_interopRequireDefault(__webpack_require__("1516"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}var _default={data:function(){return{keys:"78e2cf5d6b8404995216797147d317c1",maptrue:"block",mapleft:!0,mapright:!1,maplbtrue:"none",mappos:!0,title:"map",latitude:"",longitude:"",loadingtext:"",clcikId:"",thousand:1e3,trips:"",polylines:[],circle:[{}],selectedindex:0,mapdisgood:{name:"",address:"",distance:"",latitude:"",longitude:""},covers:[{latitude:"",longitude:"",iconPath:"../../../static/tabbar/loca.png",label:{content:"",color:"#FCFCFC",fontSize:20,bgColor:"#FF8C69",borderWidth:50,borderColor:"#FF8C69",padding:20,textAlign:"center"}}],controlss:[{id:1,position:{left:10,top:420,width:30,height:30},iconPath:"../../../static/map/map.png",clickable:!0}],scale:10,coverlist:[],Pos:"",City:"",OpenMap:!1,CloseMaps:!1,locationlat:"",locationlon:"",CityArr:"",CityCode:"",ArrLocation:[],MapHeight:"",titleheight:"",gotoheight:"",mapsheight:""}},mounted:function(){console.log(__f__("开始了"," at pages\\tabbar\\map\\map.vue:121"));var t=this;uni.getSystemInfo({success:function(i){var e=i.windowHeight;t.MapHeight=e+"px",t.titleheight="45px",t.gotoheight="85px",t.mapsheight=e-130+"px",console.log(__f__(i.windowHeight," at pages\\tabbar\\map\\map.vue:130"))}}),this.CityArr=_json.default.City,uni.getNetworkType({success:function(i){console.log(__f__(i," at pages\\tabbar\\map\\map.vue:138")),"none"!=i.networkType?(t.$refs.loading.open(),t.getmaplocation(),t.checkPermissionPos()):t.CloseMaps=!0}}),uni.onNetworkStatusChange(function(i){if(console.log(__f__(i," at pages\\tabbar\\map\\map.vue:151")),!i.isConnected)return t.OpenMap=!1,t.CloseMaps=!0,void(t.controlss[0].position.top="1000");t.$refs.loading.open(),t.getmaplocation(),t.checkPermissionPos()})},methods:{dianclick:function(t){this.clcikId=parseInt(t.mp.markerId);for(var i=0;i<this.coverlist.length;i++)this.coverlist[i].id==this.clcikId&&(this.mapdisgood.name=this.coverlist[i].name,this.mapdisgood.address=this.coverlist[i].address,this.mapdisgood.distance=this.coverlist[i].distances,this.mapdisgood.latitude=this.coverlist[i].latitude,this.mapdisgood.longitude=this.coverlist[i].longitude)},clickcontrol:function(t){this.latitude=this.locationlat,this.longitude=this.locationlon},SaveLocation:function(t,i,e){var a=this.getDisance(this.latitude,this.longitude,t,i),o=this.Transformation(a),s={latitude:t,longitude:i,iconPath:"../../../static/img/tus.png",id:e.id,address:e.address,name:e.station,distances:o.middles,label:{content:""},mid:o.mid};this.covers.push(s),this.coverlist.push(s)},sortDistances:function(t,i){return t=parseFloat(t.mid),i=parseFloat(i.mid),t-i},bd_decrypt:function(t,i){var e=3e3*Math.PI/180,a=t-.0065,o=i-.006,s=Math.sqrt(a*a+o*o)-2e-5*Math.sin(o*e),n=Math.atan2(o,a)-3e-6*Math.cos(a*e),d=s*Math.cos(n),l=s*Math.sin(n);return{lng:d,lat:l}},getmaplocation:function getmaplocation(){var _this2=this,_this=this,myAmapFun=new _amapWx.default.AMapWX({key:this.keys});myAmapFun.getRegeo({success:function success(data){_this2.latitude=data[0].latitude,_this2.longitude=data[0].longitude,_this2.locationlat=data[0].latitude,_this2.locationlon=data[0].longitude,_this2.Pos=_this2.longitude+","+_this2.latitude,_this2.circle[0].latitude=_this2.latitude,_this2.circle[0].longitude=_this2.longitude,_this2.covers[0].latitude=_this2.latitude,_this2.covers[0].longitude=_this2.longitude,_this2.circle[0].color="#FF0000",_this2.circle[0].fillColor="#FF0000",_this2.circle[0].radius=50,_this2.City=data[0].regeocodeData.addressComponent.city,_this2.CityArr.forEach(function(t){t.text==_this.City&&(_this.CityCode=t.id)});var datas='{method:"GetStationInfo",city_code:"'.concat(_this2.CityCode,'"}');console.log(__f__(JSON.stringify(datas)," at pages\\tabbar\\map\\map.vue:258")),uni.request({url:"http://www.uzdust.cn/App/Common/CSharp/app/user/UserInfo.ashx",data:{params:datas},success:function success(res){1==res.data.result&&(_this.ArrLocation=eval(res.data.data),_this.ArrLocation.forEach(function(t){var i=_this.bd_decrypt(t.longitude,t.latitude);_this.SaveLocation(i.lat,i.lng,t)}),_this.coverlist.sort(_this.sortDistances),_this.coverlist[0].label.content=_this.coverlist[0].name,_this.mapdisgood.name=_this.coverlist[0].name,_this.mapdisgood.address=_this.coverlist[0].address,_this.mapdisgood.distance=_this.coverlist[0].distances,_this.mapdisgood.latitude=_this.coverlist[0].latitude,_this.mapdisgood.longitude=_this.coverlist[0].longitude,_this.$refs.loading.close(),_this.OpenMap=!0)}})},fail:function(t){console.log(__f__(t," at pages\\tabbar\\map\\map.vue:287"))}})},mappointers:function(){this.polylines=[],this.polylines.push({points:[{longitude:this.longitude,latitude:this.latitude},{longitude:this.mapdisgood.longitude,latitude:this.mapdisgood.latitude}],color:"#FF6347",width:5,dottedLine:!1,borderWidth:3})},mapleftmethods:function(){this.mapleft=!0,this.mapright=!1,this.maptrue="block",this.maplbtrue="none",this.mappos=!0,this.controlss[0].position.top="420"},maprightmethods:function(){this.mapleft=!1,this.mapright=!0,this.maptrue="none",this.maplbtrue="block",this.mappos=!1,this.controlss[0].position.top="1000"},toRad:function(t){return t*Math.PI/180},getDisance:function(t,i,e,a){var o=0,s=this.toRad(t),n=this.toRad(e),d=s-n,l=this.toRad(i)-this.toRad(a);o=2*Math.asin(Math.sqrt(Math.pow(Math.sin(d/2),2)+Math.cos(s)*Math.cos(n)*Math.pow(Math.sin(l/2),2)));return 6378137*o},Transformation:function(t){var i=parseInt(t);if(i<this.thousand)return{middles:i+"m",mid:.001*i};var e=parseInt(i/this.thousand),a=parseInt(i%this.thousand).toString();return a=a.substring(0,2),{middles:e+"."+a+"km",mid:e+"."+a}},Gomap:function(){uni.openLocation({name:this.mapdisgood.name,address:this.mapdisgood.address,latitude:parseFloat(this.mapdisgood.latitude),longitude:parseFloat(this.mapdisgood.longitude),scale:28})},getMappos:function(t){this.coverlist.forEach(function(i){i.id==t.id?i.label.content=i.name:i.label.content=""}),this.mapdisgood.name=t.name,this.mapdisgood.address=t.address,this.mapdisgood.distance=t.distances,this.mapdisgood.latitude=t.latitude,this.mapdisgood.longitude=t.longitude,this.latitude=t.latitude,this.longitude=t.longitude,this.mapleftmethods(),this.mappointers()},checkPermissionPos:function(){plus.geolocation.getCurrentPosition(function(t){console.log(__f__("Geolocation\nLatitude:"+t.coords.latitude+"\nLongitude:"+t.coords.longitude+"\nAltitude:"+t.coords.altitude," at pages\\tabbar\\map\\map.vue:384"))},function(t){switch(t.code){case t.PERMISSION_DENIED:plus.nativeUI.alert("用户拒绝了地理定位请求.");break;case t.POSITION_UNAVAILABLE:plus.nativeUI.alert("位置信息不可用.");break;case t.TIMEOUT:plus.nativeUI.alert("获取用户位置的请求超时.");break;case t.UNKNOWN_ERROR:plus.nativeUI.alert("未知错误.");break}})},Gorefueling:function(){uni.navigateTo({url:"../../function/Buygasrolls/Buygasrolls",animationType:"pop-in",animationDuration:200})}}};exports.default=_default}).call(this,__webpack_require__("0de9")["default"],__webpack_require__("6e42")["default"])},bd10:function(t,i,e){"use strict";(function(t){e("d7b2"),e("921b");a(e("66fd"));var i=a(e("4b4c"));function a(t){return t&&t.__esModule?t:{default:t}}t(i.default)}).call(this,e("6e42")["createPage"])},c10d:function(t,i,e){"use strict";var a=function(){var t=this,i=t.$createElement;t._self._c},o=[];e.d(i,"a",function(){return a}),e.d(i,"b",function(){return o})},c3ac:function(t,i,e){"use strict";e.r(i);var a=e("afaa"),o=e.n(a);for(var s in a)"default"!==s&&function(t){e.d(i,t,function(){return a[t]})}(s);i["default"]=o.a}},[["bd10","common/runtime","common/vendor"]]]);